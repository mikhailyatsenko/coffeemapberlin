# MainPage Module

## Описание

Модуль главной страницы приложения, который отображает карту с местами и список мест.

## Структура

```
src/pages/MainPage/
├── components/          # Внутренние компоненты (пока пусто)
├── constants/           # Константы модуля
│   └── index.ts        # PAGE_SIZE, INITIAL_OFFSET
├── lib/                 # Бизнес-логика
│   └── usePlacesDataLoader.ts  # Хук для загрузки данных о местах
├── types/               # Типы модуля
│   └── index.ts        # PlacesGeoData, MainPageProps
├── ui/                  # Публичный компонент
│   └── MainPage.tsx    # Основной компонент страницы
├── index.ts             # Публичный API модуля
└── README.md            # Документация
```

## Рефакторинг

### Проблемы до рефакторинга

1. **Дублирование данных**: При нажатии на кнопку избранного `moreData` могла добавляться повторно, увеличивая количество мест с 450 до 890
2. **Потеря данных**: Иногда оставалось только 10 мест из `initialData`
3. **Сложная логика**: Вся логика загрузки данных была в компоненте MainPage

### Решения

1. **Выделение логики в хук**: Создан `usePlacesDataLoader` для управления загрузкой данных
2. **Флаги состояния**: Использованы `useRef` для отслеживания состояния загрузки
3. **Проверка дубликатов**: Добавлена проверка существующих ID перед добавлением новых мест
4. **Разделение ответственности**: Логика загрузки вынесена в отдельный слой

### Ключевые улучшения

- **Предотвращение дублирования**: Проверка существующих ID через `Set`
- **Контроль состояния загрузки**: Флаги `isInitialLoadComplete` и `isMoreDataLoaded`
- **Чистая архитектура**: Следование FSD принципам
- **Переиспользуемость**: Хук можно использовать в других компонентах

## Использование

```tsx
import { MainPage } from 'pages/MainPage';

// В роутере или другом компоненте
<MainPage />
```

## API

### usePlacesDataLoader

Хук для управления загрузкой данных о местах.

**Возвращает:**
- `initialLoading: boolean` - состояние первоначальной загрузки
- `moreDataLoading: boolean` - состояние загрузки дополнительных данных

**Особенности:**
- Автоматически загружает все места (не только первые 10)
- Предотвращает дублирование данных
- Оптимизирован для работы с избранным
